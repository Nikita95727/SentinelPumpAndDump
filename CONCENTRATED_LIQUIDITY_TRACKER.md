# Concentrated Liquidity Tracker

## Описание

Служебное средство для отслеживания токенов с концентрированной ликвидностью (>50% у одного держателя). Цель - найти возможности безопасного входа/выхода и способы переиграть манипуляторов.

## Как работает

1. **Автоматическое обнаружение**: Когда токен отклоняется фильтрами из-за концентрированной ликвидности, автоматически запускается отслеживание
2. **Мониторинг**: Трекер собирает снимки каждые 30 секунд:
   - Цена токена
   - Ликвидность
   - Количество holders
   - Процент топ-держателя
3. **Анализ возможностей**:
   - **Вход**: Цена упала >20% от пика, ликвидность увеличилась >10%
   - **Выход**: Цена выросла >50%, ликвидность резко уменьшилась >30%
4. **Детальное логирование**: Все данные сохраняются в `logs/concentrated-liquidity/`

## Структура логов

### Файлы для каждого токена:
- `{mint}.jsonl` - Снимки состояния (каждые 30 секунд)
- `{mint}.events.jsonl` - События (вход/выход возможности)
- `{mint}.report.json` - Финальный отчет после завершения отслеживания

### Формат снимка:
```json
{
  "timestamp": "2025-12-30T12:00:00.000Z",
  "mint": "TokenMint...",
  "snapshot": {
    "timestamp": 1735560000000,
    "price": 0.000123456,
    "liquidity": 1500.50,
    "holders": 25,
    "topHolderPct": 65.2
  },
  "stats": {
    "peakPrice": 0.000200000,
    "lowestPrice": 0.000100000,
    "maxLiquidity": 2000.00,
    "minLiquidity": 1000.00,
    "entryOpportunities": 3,
    "exitOpportunities": 1
  }
}
```

### Формат события:
```json
{
  "timestamp": "2025-12-30T12:00:00.000Z",
  "mint": "TokenMint...",
  "eventType": "ENTRY_OPPORTUNITY",
  "data": {
    "price": 0.000150000,
    "priceFromPeak": -25.0,
    "liquidity": 1800.00,
    "reason": "Price drop from peak"
  }
}
```

## Параметры отслеживания

- **Длительность**: 24 часа с момента обнаружения
- **Интервал снимков**: 30 секунд
- **Интервал проверки цены**: 10 секунд
- **Минимальное падение для входа**: 20% от пика
- **Минимальный рост для выхода**: 50% от начальной цены
- **Порог изменения ликвидности**: ±10% для входа, -30% для выхода

## Анализ данных

### Что искать:

1. **Паттерны манипуляций**:
   - Резкое увеличение ликвидности перед ростом цены
   - Резкое уменьшение ликвидности после роста цены
   - Циклы накачки/сброса

2. **Безопасные окна входа**:
   - Цена упала от пика, но ликвидность стабильна
   - Манипулятор добавляет ликвидность (готовится к накачке)

3. **Сигналы выхода**:
   - Ликвидность резко падает (манипулятор выводит)
   - Цена достигла хорошего multiplier (>2x)

## Использование

Трекер работает автоматически. Все токены с концентрированной ликвидностью автоматически начинают отслеживаться.

Для просмотра данных:
```bash
# Просмотр снимков токена
cat logs/concentrated-liquidity/{mint}.jsonl | jq

# Просмотр событий
cat logs/concentrated-liquidity/{mint}.events.jsonl | jq

# Просмотр финального отчета
cat logs/concentrated-liquidity/{mint}.report.json | jq
```

## Метрики для анализа

- **peakPrice / lowestPrice**: Диапазон цен
- **maxLiquidity / minLiquidity**: Диапазон ликвидности
- **entryOpportunities**: Количество обнаруженных возможностей входа
- **exitOpportunities**: Количество обнаруженных возможностей выхода
- **totalReturn**: Общий возврат за период отслеживания

## Цель

Найти паттерны поведения манипуляторов и определить безопасные моменты для входа/выхода, чтобы переиграть их стратегию.

