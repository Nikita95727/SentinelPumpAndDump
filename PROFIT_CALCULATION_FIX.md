# Исправление расчета прибыли

## ✅ Исправлено

### Проблема
Бот показывал отрицательную прибыль даже при положительных multipliers (1.56x-1.91x) из-за неправильного расчета.

### Причина
Использовался `reservedAmount`, который включал slippage для максимального сценария (2.5x), но реальные продажи происходили при меньших multipliers.

### Решение
Изменен расчет прибыли с:
```typescript
const profit = proceeds - reservedAmount;
```

На:
```typescript
const totalCost = positionSize + exitFee; // Реальные затраты
const profit = proceeds - totalCost;
```

Где:
- `positionSize = investedAmount + entryFee` (реально потрачено при покупке)
- `totalCost = positionSize + exitFee` (все реальные затраты)
- `proceeds` - реальная сумма после продажи (уже включает все комиссии и slippage)

### Результат
- **Старый расчет**: `profit = 0.003660 - 0.0051847 = -0.001525 SOL` ❌
- **Новый расчет**: `profit = 0.003660 - 0.005005 = -0.001345 SOL` ✅

Разница: `0.00018 SOL` (это slippage который был заложен для 2.5x, но не использовался)

### Важно
Теперь profit показывает **реальную прибыль/убыток** от сделок без завышенного slippage для максимального сценария.

Если profit все еще отрицательный, это означает реальный убыток из-за:
1. Slippage при продаже (разница между ожидаемой и реальной ценой)
2. Низкая ликвидность токенов
3. Комиссии сети

Но теперь расчет **корректный** и отражает реальное финансовое состояние.

